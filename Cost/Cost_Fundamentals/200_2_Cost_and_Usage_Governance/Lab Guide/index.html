<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Level 200: Cost and Usage Governance - My Docs</title>
        <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../../..">My Docs</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../../..">Welcome to MkDocs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cost <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../">AWS Well-Architected Cost Optimization Labs</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Cost Fundamentals</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">100 1 AWS Account Setup</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../100_1_AWS_Account_Setup/">Level 100: AWS Account Setup</a>
</li>
            
<li >
    <a href="../../100_1_AWS_Account_Setup/Checklist/">Level 100: AWS Account Setup: Best Practice Checklist</a>
</li>
            
<li >
    <a href="../../100_1_AWS_Account_Setup/Lab Guide/">Level 100: AWS Account Setup: Lab Guide</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">100 2 Cost and Usage Governance</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../100_2_Cost_and_Usage_Governance/">Level 100: Cost and Usage Governance</a>
</li>
            
<li >
    <a href="../../100_2_Cost_and_Usage_Governance/Checklist/">Level 100: Cost and Usage Governance</a>
</li>
            
<li >
    <a href="../../100_2_Cost_and_Usage_Governance/Lab Guide/">Level 100: Cost and Usage Governance</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">100 4 Cost and Usage Analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../100_4_Cost_and_Usage_Analysis/">Level 100: Cost and Usage Analysis</a>
</li>
            
<li >
    <a href="../../100_4_Cost_and_Usage_Analysis/Checklist/">Level 100: Cost and Usage Analysis</a>
</li>
            
<li >
    <a href="../../100_4_Cost_and_Usage_Analysis/Lab Guide/">Level 100: Cost and Usage Analysis</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">100 5 Cost Visualization</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../100_5_Cost_Visualization/">Level 100: Billing Visualization</a>
</li>
            
<li >
    <a href="../../100_5_Cost_Visualization/Checklist/">Level 100: Cost Visualization</a>
</li>
            
<li >
    <a href="../../100_5_Cost_Visualization/Lab Guide/">Level 100: Cost Visualization</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">200 2 Cost and Usage Governance</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../">Level 200: Cost and Usage Governance</a>
</li>
            
<li >
    <a href="../Checklist/">Level 200: Cost and Usage Governance</a>
</li>
            
<li class="active">
    <a href="./">Level 200: Cost and Usage Governance</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">200 3 Pricing Models</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../200_3_Pricing_Models/">Level 200: Pricing Models</a>
</li>
            
<li >
    <a href="../../200_3_Pricing_Models/Checklist/">Level 200: Pricing Models Checklist</a>
</li>
            
<li >
    <a href="../../200_3_Pricing_Models/Lab Guide/">Level 200: Pricing Models</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">200 4 Cost and Usage Analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../200_4_Cost_and_Usage_Analysis/">Level 200: Cost and Usage Analysis</a>
</li>
            
<li >
    <a href="../../200_4_Cost_and_Usage_Analysis/Checklist/">Level 200: Cost and Usage Analysis</a>
</li>
            
<li >
    <a href="../../200_4_Cost_and_Usage_Analysis/Lab Guide/">Level 200: Cost and Usage Analysis</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">200 5 Cost Visualization</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../200_5_Cost_Visualization/">Level 200: Cost Visualization</a>
</li>
            
<li >
    <a href="../../200_5_Cost_Visualization/Checklist/">Level 200: Cost Visualization</a>
</li>
            
<li >
    <a href="../../200_5_Cost_Visualization/Lab Guide/">Level 200: Cost Visualization</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Cost and Usage Analysis</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Cost_and_Usage_Analysis/">AWS Well-Architected Cost Optimization Labs</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">300 Automated CUR Updates and Ingestion</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Cost_and_Usage_Analysis/300_Automated_CUR_Updates_and_Ingestion/">Level 300: Automated CUR Updates and Ingestion</a>
</li>
            
<li >
    <a href="../../../Cost_and_Usage_Analysis/300_Automated_CUR_Updates_and_Ingestion/Checklist/">Level 300: Automated CUR Updates and Ingestion</a>
</li>
            
<li >
    <a href="../../../Cost_and_Usage_Analysis/300_Automated_CUR_Updates_and_Ingestion/Lab Guide/">Level 300: Automated CUR Updates and Ingestion</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reliability <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../Reliability/">AWS Well-Architected Reliability Labs</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">300   Testing for Resiliency of EC2, RDS, and S3</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Reliability/300 - Testing for Resiliency of EC2, RDS, and S3/">Level 300: Testing for Resiliency of EC2, RDS, and S3</a>
</li>
            
<li >
    <a href="../../../../Reliability/300 - Testing for Resiliency of EC2, RDS, and S3/Builders Guide/">Builders Guide for 300 - Testing for Resiliency of EC2, RDS, and S3</a>
</li>
            
<li >
    <a href="../../../../Reliability/300 - Testing for Resiliency of EC2, RDS, and S3/Lab Guide/">Level 300: Performing Resiliency Testing for EC2, RDS, and S3</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Security <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../Security/">AWS Well-Architected Security Labs</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">100   AWS Account & Root User</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/100 - AWS Account & Root User/">Level 100: AWS Account & Root User</a>
</li>
            
<li >
    <a href="../../../../Security/100 - AWS Account & Root User/Checklist/">Level 100: AWS Account & Root User: Best Practice Checklist</a>
</li>
            
<li >
    <a href="../../../../Security/100 - AWS Account & Root User/Lab Guide/">Level 100: AWS Account & Root User: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">100   Basic Identity & Access Management User, Group, Role</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/100 - Basic Identity & Access Management User, Group, Role/">Level 100: Basic Identity & Access Management User, Group, Role</a>
</li>
            
<li >
    <a href="../../../../Security/100 - Basic Identity & Access Management User, Group, Role/Checklist/">Level 100: Basic Identity & Access Management User, Group, Role: Best Practice Checklist</a>
</li>
            
<li >
    <a href="../../../../Security/100 - Basic Identity & Access Management User, Group, Role/Lab Guide/">Level 100: Basic Identity & Access Management User, Group, Role: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">100   CloudFront with S3 Bucket Origin</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/100 - CloudFront with S3 Bucket Origin/">Level 100: CloudFront with S3 Bucket Origin</a>
</li>
            
<li >
    <a href="../../../../Security/100 - CloudFront with S3 Bucket Origin/Lab Guide/">Level 100: CloudFront with S3 Bucket Origin: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">200   Automated Deployment of Detective Controls</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of Detective Controls/">Level 200: Automated Deployment of Detective Controls</a>
</li>
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of Detective Controls/Lab Guide/">Level 200: Automated Deployment of Detective Controls: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">200   Automated Deployment of EC2 Web Application</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of EC2 Web Application/">Level 200: Automated Deployment of EC2 Web Application</a>
</li>
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of EC2 Web Application/Lab Guide/">Level 200: Automated Deployment of EC2 Web Application</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">200   Automated Deployment of IAM Groups and Roles</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of IAM Groups and Roles/">Level 200: Automated Deployment of IAM Groups and Roles</a>
</li>
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of IAM Groups and Roles/Lab Guide/">Level 200: Automated Deployment of IAM Groups and Roles: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">200   Automated Deployment of VPC</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of VPC/">Level 200: Automated Deployment of VPC</a>
</li>
            
<li >
    <a href="../../../../Security/200 - Automated Deployment of VPC/Lab Guide/">Level 200: Automated Deployment of VPC</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">200   Basic EC2 with WAF Protection</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/200 - Basic EC2 with WAF Protection/">Level 200: EC2 Web Infrastructure Protection</a>
</li>
            
<li >
    <a href="../../../../Security/200 - Basic EC2 with WAF Protection/Checklist/">Level 100: EC2 Web Infrastructure Protection: Best Practice Checklist</a>
</li>
            
<li >
    <a href="../../../../Security/200 - Basic EC2 with WAF Protection/Lab Guide/">Level 200: EC2 Web Infrastructure Protection: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">200   CloudFront with WAF Protection</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/200 - CloudFront with WAF Protection/">Level 200: CloudFront with WAF Protection</a>
</li>
            
<li >
    <a href="../../../../Security/200 - CloudFront with WAF Protection/Lab Guide/">Level 100: CloudFront with WAF Protection: Lab Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">300   IAM Permission Boundaries Delegating Role Creation</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/300 - IAM Permission Boundaries Delegating Role Creation/">Level 300: IAM Permission Boundaries Delegating Role Creation</a>
</li>
            
<li >
    <a href="../../../../Security/300 - IAM Permission Boundaries Delegating Role Creation/Lab Guide/">Level 300: IAM Permission Boundaries Delegating Role Creation</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">300   IAM Tag Based Access Control for EC2</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Security/300 - IAM Tag Based Access Control for EC2/">Level 300: IAM Tag Based Access Control for EC2</a>
</li>
            
<li >
    <a href="../../../../Security/300 - IAM Tag Based Access Control for EC2/Lab Guide/">Level 300: IAM Tag Based Access Control for EC2</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../Checklist/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../../200_3_Pricing_Models/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#level-200-cost-and-usage-governance">Level 200: Cost and Usage Governance</a></li>
            <li><a href="#authors">Authors</a></li>
            <li><a href="#feedback">Feedback</a></li>
        <li class="main "><a href="#table-of-contents">Table of Contents</a></li>
            <li><a href="#1-create-a-cost-optimization-team">1. Create a cost optimization team </a></li>
            <li><a href="#2-create-an-iam-policy-to-restrict-service-usage-by-region">2. Create an IAM Policy to restrict service usage by region </a></li>
            <li><a href="#3-create-an-iam-policy-to-restirct-ec2-usage-by-family">3. Create an IAM Policy to restirct EC2 usage by family </a></li>
            <li><a href="#4-extend-an-iam-policy-to-restrict-ec2-usage-by-instance-size">4. Extend an IAM Policy to restrict EC2 usage by instance size </a></li>
            <li><a href="#5-create-an-iam-policy-to-restrict-ebs-volume-creation-by-volume-type">5. Create an IAM policy to restrict EBS Volume creation by volume type </a></li>
            <li><a href="#6-tear-down">6. Tear down </a></li>
            <li><a href="#7-survey">7. Survey </a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="level-200-cost-and-usage-governance">Level 200: Cost and Usage Governance</h1>
<h2 id="authors">Authors</h2>
<ul>
<li>Nathan Besh, Cost Lead Well-Architected</li>
<li>Spencer Marley, Commercial Architect</li>
</ul>
<h2 id="feedback">Feedback</h2>
<p>If you wish to provide feedback on this lab, there is an error, or you want to make a suggestion, please email: costoptimization@amazon.com</p>
<h1 id="table-of-contents">Table of Contents</h1>
<ol>
<li><a href="#create_team">Create a cost optimization team</a></li>
<li><a href="#EC2_restrict_region">Create an IAM Policy to restrict EC2 usage by region</a></li>
<li><a href="#EC2_restrict_family">Create an IAM Policy to restirct EC2 usage by family</a></li>
<li><a href="#EC2_restrict_size">Extend an IAM Policy to restrict EC2 usage by instance size</a></li>
<li><a href="#EC2_volume_type">Create an IAM policy to restrict EBS Volume creation by volume type</a></li>
<li><a href="#tear_down">Tear down</a></li>
<li><a href="#survey">Feedback survey</a>  </li>
</ol>
<h2 id="1-create-a-cost-optimization-team">1. Create a cost optimization team <a name="create_team"></a></h2>
<p>We are going to create a cost optimization team. Within your organization there needs to be a team of people that are focused around costs and usage. This exercise will create the users and the group, then assign all the access they need.
This team will then be able to manage the organizations cost and usage, and start to implement optimization mechanisms.</p>
<h3 id="11-create-an-iam-policy-for-the-team">1.1 Create an IAM policy for the team</h3>
<p>This provides access to allow the cost optimization team to perform their work, namely the Labs in the 100 level fundamental series. This is the minimum access the team requires.</p>
<ol>
<li>
<p>Log into the console as an IAM user with the required permissions and go to the <strong>IAM</strong> Service page:
<img alt="Images/AWSIAM1.png" src="../Images/AWSIAM1.png" /></p>
</li>
<li>
<p>Select <strong>Policies</strong> from the left menu:
<img alt="Images/AWSIAM2.png" src="../Images/AWSIAM2.png" /></p>
</li>
<li>
<p>Select <strong>Create Policy</strong>:
<img alt="Images/AWSIAM3.png" src="../Images/AWSIAM3.png" /></p>
</li>
<li>
<p>Select the <strong>JSON</strong> tab:
<img alt="Images/AWSIAM4.png" src="../Images/AWSIAM4.png" /></p>
</li>
<li>
<p>Modify the policy below, replace <strong>-billing bucket-</strong> (2 replacements) with the name of the bucket your CUR files are delivered to. Then copy &amp; paste the policy into the the field:
<strong>NOTE</strong>: Ensure you copy the entire policy, everything including the first '{' and last '}'</p>
</li>
</ol>
<pre><code>{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;VisualEditor0&quot;,
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [
        &quot;s3:GetObject&quot;,
        &quot;s3:ListBucket&quot;
      ],
      &quot;Resource&quot;: [
        &quot;arn:aws:s3:::-billing bucket-&quot;,
        &quot;arn:aws:s3:::-billing bucket-/*&quot;
      ]
    },
    {
      &quot;Sid&quot;: &quot;VisualEditor1&quot;,
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [
        &quot;iam:GetPolicyVersion&quot;,
        &quot;quicksight:CreateAdmin&quot;,
        &quot;iam:DeletePolicy&quot;,
        &quot;iam:CreateRole&quot;,
        &quot;iam:AttachRolePolicy&quot;,
        &quot;aws-portal:ViewUsage&quot;,
        &quot;iam:GetGroup&quot;,
        &quot;aws-portal:ModifyBilling&quot;,
        &quot;iam:DetachRolePolicy&quot;,
        &quot;iam:ListAttachedRolePolicies&quot;,
        &quot;ds:UnauthorizeApplication&quot;,
        &quot;aws-portal:ViewBilling&quot;,
        &quot;iam:DetachGroupPolicy&quot;,
        &quot;iam:ListAttachedGroupPolicies&quot;,
        &quot;iam:CreatePolicyVersion&quot;,
        &quot;ds:CheckAlias&quot;,
        &quot;quicksight:Subscribe&quot;,
        &quot;ds:DeleteDirectory&quot;,
        &quot;iam:ListPolicies&quot;,
        &quot;iam:GetRole&quot;,
        &quot;ds:CreateIdentityPoolDirectory&quot;,
        &quot;ds:DescribeTrusts&quot;,
        &quot;iam:GetPolicy&quot;,
        &quot;iam:ListGroupPolicies&quot;,
        &quot;aws-portal:ViewAccount&quot;,
        &quot;iam:ListEntitiesForPolicy&quot;,
        &quot;iam:AttachUserPolicy&quot;,
        &quot;iam:ListRoles&quot;,
        &quot;iam:DeleteRole&quot;,
        &quot;budgets:*&quot;,
        &quot;iam:CreatePolicy&quot;,
        &quot;quicksight:CreateUser&quot;,
        &quot;s3:ListAllMyBuckets&quot;,
        &quot;iam:ListPolicyVersions&quot;,
        &quot;iam:AttachGroupPolicy&quot;,
        &quot;quicksight:Unsubscribe&quot;,
        &quot;iam:ListAccountAliases&quot;,
        &quot;ds:DescribeDirectories&quot;,
        &quot;iam:ListGroups&quot;,
        &quot;iam:GetGroupPolicy&quot;,
        &quot;ds:CreateAlias&quot;,
        &quot;ds:AuthorizeApplication&quot;,
        &quot;iam:DeletePolicyVersion&quot;
      ],
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
}
</code></pre>

<ol>
<li>
<p>Click <strong>Review policy</strong>: 
<img alt="Images/AWSIAM5.png" src="../Images/AWSIAM5.png" /></p>
</li>
<li>
<p>Enter a <strong>Name</strong> and <strong>Description</strong> for the policy and click <strong>Create policy</strong>:
<img alt="Images/AWSIAM6.png" src="../Images/AWSIAM6.png" /></p>
</li>
</ol>
<p>You have successfully created the cost optimization teams policy.</p>
<h3 id="12-create-an-iam-group">1.2 Create an IAM Group</h3>
<p>This group will bring together IAM users and apply the required policies.</p>
<ol>
<li>
<p>While in the IAM console, select <strong>Groups</strong> from the left menu:
<img alt="Images/AWSIAM7.png" src="../Images/AWSIAM7.png" /></p>
</li>
<li>
<p>Click on <strong>Create New Group</strong>:
<img alt="Images/AWSIAM8.png" src="../Images/AWSIAM8.png" /></p>
</li>
<li>
<p>Enter a <strong>Group Name</strong> and click <strong>Next Step</strong>:
<img alt="Images/AWSIAM9.png" src="../Images/AWSIAM9.png" /></p>
</li>
<li>
<p>Click <strong>Policy Type</strong> and select <strong>Customer Managed</strong>:
<img alt="Images/AWSIAM10.png" src="../Images/AWSIAM10.png" /></p>
</li>
<li>
<p>Select the <strong>CostOptimization_Summit</strong> policy (created previously):
<img alt="Images/AWSIAM11.png" src="../Images/AWSIAM11.png" /></p>
</li>
<li>
<p>We will now add more policies, click on <strong>Customer Managed</strong> and select <strong>AWS Managed</strong>:
<img alt="Images/AWSIAM12.png" src="../Images/AWSIAM12.png" /></p>
</li>
<li>
<p>Type <strong>Athena</strong> into the filter box, select <strong>both</strong> policies, and click <strong>Next Step</strong>:
<img alt="Images/AWSIAM13.png" src="../Images/AWSIAM13.png" /></p>
</li>
<li>
<p>Click <strong>Create Group</strong>:
<img alt="Images/AWSIAM14.png" src="../Images/AWSIAM14.png" /></p>
</li>
</ol>
<p>You have now successfully created the cost optimization group, and attached the required policies.</p>
<h3 id="13-create-an-iam-user">1.3 Create an IAM User</h3>
<p>For this lab we will create a user and join them to the group above.</p>
<p>NOTE: it is best practice to have Multi Factor Authentication (MFA) enabled for all users. We omit this step here for brevity and simplicity, and should only be implemented as a demonstration before being removed/rectified.</p>
<ol>
<li>
<p>In the IAM console, select <strong>Users</strong> from the left menu:
<img alt="Images/AWSIAM15.png" src="../Images/AWSIAM15.png" /></p>
</li>
<li>
<p>Click <strong>Add user</strong>:
<img alt="Images/AWSIAM16.png" src="../Images/AWSIAM16.png" /></p>
</li>
<li>
<p>Enter a <strong>User name</strong>, select <strong>AWS Management Console access</strong>, choose <strong>Custom Password</strong>, type a suitable password, deselect <strong>Require password reset</strong>, and click <strong>Next: Permissions</strong>:
<img alt="Images/AWSIAM17.png" src="../Images/AWSIAM17.png" /></p>
</li>
<li>
<p>Select the <strong>CostOptimization</strong> group (created previously), and click <strong>Next: Tags</strong>:
<img alt="Images/AWSIAM18.png" src="../Images/AWSIAM18.png" /></p>
</li>
<li>
<p>Click <strong>Next Review</strong>:
<img alt="Images/AWSIAM19.png" src="../Images/AWSIAM19.png" /></p>
</li>
<li>
<p>Click <strong>Create user</strong>:
<img alt="Images/AWSIAM20.png" src="../Images/AWSIAM20.png" /></p>
</li>
<li>
<p>Copy the link provided, and logout by clicking on your username in the top right, and selecting <strong>Sign Out</strong>::
<img alt="Images/AWSIAM21.png" src="../Images/AWSIAM21.png" /></p>
</li>
<li>
<p>Log back in as the username you just created, with the link you copied for the remainder of the Lab.
<img alt="Images/AWSIAM21.png" src="../Images/AWSIAM22.png" /></p>
</li>
</ol>
<p>You have successfully create a user, placed them in the cost optimization group and have applied policies.
You can continue to expand this group by adding additional users from your organization.</p>
<h2 id="2-create-an-iam-policy-to-restrict-service-usage-by-region">2. Create an IAM Policy to restrict service usage by region <a name="EC2_restrict_region"></a></h2>
<p>To manage costs you need to manage and control your usage. AWS offers multilpe regions, so depending on your business requirements you can limit access to AWS services depending on the region. This can be used to ensure usage is only allowed in specific regions which are more cost effective, and minimize associated usage and cost, such as data transfer.</p>
<p>We will create a policy that allows all EC2, RDS and S3 access in a single region only. NOTE: it is best practice to provide only the minimum access required, the policy used here is for brevity and simplicity, and should only be implemented as a demonstration before being removed.</p>
<h3 id="21-create-the-iam-policy">2.1 Create the IAM Policy</h3>
<ol>
<li>
<p>Go to the <strong>IAM</strong> service page: 
<img alt="Images/AWSPolicy1.png" src="../Images/AWSPolicy1.png" /></p>
</li>
<li>
<p>Select <strong>Policies</strong> from the left menu:
<img alt="Images/AWSPolicy2.png" src="../Images/AWSPolicy2.png" /></p>
</li>
<li>
<p>Click <strong>Create Policy</strong>:
<img alt="Images/AWSPolicy3.png" src="../Images/AWSPolicy3.png" /></p>
</li>
<li>
<p>Click the <strong>JSON</strong> tab:
<img alt="Images/AWSPolicy4.png" src="../Images/AWSPolicy4.png" /></p>
</li>
<li>
<p>Open the following text file, copy and paste the policy into the console:
<strong>NOTE</strong> Ensure you copy the entire policy, including the start '{' and end '}' 
<img alt="./Code/Region_Restrict" src="./Code/Region_Restrict" /> </p>
</li>
<li>
<p>Click <strong>Review policy</strong>:
<img alt="Images/AWSPolicy5.png" src="../Images/AWSPolicy5.png" />
NOTE: the policy may be different from the image above</p>
</li>
<li>
<p>Enter a <strong>Name</strong> and <strong>Description</strong>, and click <strong>Create policy</strong>: 
<img alt="Images/AWSPolicy6.png" src="../Images/AWSPolicy6.png" /></p>
</li>
</ol>
<p>You have successfully created the Policy.</p>
<h3 id="22-apply-it-to-a-group">2.2 Apply it to a group</h3>
<ol>
<li>
<p>Select <strong>Groups</strong> from the left menu:
<img alt="Images/AWSPolicy7.png" src="../Images/AWSPolicy7.png" /></p>
</li>
<li>
<p>Click on the <strong>CostOptimization</strong> group (created previously):
<img alt="Images/AWSPolicy8.png" src="../Images/AWSPolicy8.png" /></p>
</li>
<li>
<p>Select the <strong>Permissions</strong> tab:
<img alt="Images/AWSPolicy9.png" src="../Images/AWSPolicy9.png" /></p>
</li>
<li>
<p>Click <strong>Attach Policy</strong>:
<img alt="Images/AWSPolicy10.png" src="../Images/AWSPolicy10.png" /></p>
</li>
<li>
<p>Click <strong>Policy Type</strong> and select <strong>Customer Managed</strong>:
<img alt="Images/AWSPolicy12.png" src="../Images/AWSPolicy12.png" /></p>
</li>
<li>
<p>Select the checkbox next to <strong>Region_Restrict</strong> (created above) and click <strong>Attach Policy</strong>:
<img alt="Images/AWSPolicy13.png" src="../Images/AWSPolicy13.png" /></p>
</li>
</ol>
<p>You have successfully attached the policy to the Cost Optimizaiton group. </p>
<h3 id="23-verify-the-policy-is-in-effect">2.3 Verify the policy is in effect</h3>
<ol>
<li>
<p>Go to the EC2 Service dashboard: 
<img alt="Images/AWSPolicy14.png" src="../Images/AWSPolicy14.png" /></p>
</li>
<li>
<p>Click the current region in the top right, and select <strong>US West (N.California)</strong>: 
<img alt="Images/AWSPolicy15.png" src="../Images/AWSPolicy15.png" /></p>
</li>
<li>
<p>You will notice that there are authorization messages due to not having access in that region (the policy restricted EC2 usage to N. Virginia only):
<img alt="Images/AWSPolicy16.png" src="../Images/AWSPolicy16.png" /></p>
</li>
<li>
<p>Try to launch an instance by clicking <strong>Launch Instance</strong>:
<img alt="Images/AWSPolicy17.png" src="../Images/AWSPolicy17.png" /></p>
</li>
<li>
<p>Click on <strong>Select</strong> next to the <strong>Amazon Linux 2 AMI</strong>, You will receive an error when you select an AMI as you do not have permissions:
<img alt="Images/AWSPolicy18.png" src="../Images/AWSPolicy18.png" /></p>
</li>
</ol>
<p>You have successfully verified that you can not launch any instances outside of the N.Virginia region. We will now verify we have access in us-east-1 (N.Virginia):</p>
<ol>
<li>
<p>Change the region by clicking the current region, and selecting <strong>US East (N.Virginia)</strong>:
<img alt="Images/AWSPolicy19.png" src="../Images/AWSPolicy19.png" /></p>
</li>
<li>
<p>Now attempt to launch an instance, choose the <strong>Amazon Linux 2 AMI</strong>, leave <strong>64-bit (x86)</strong> selected, click <strong>Select</strong>:
<img alt="Images/AWSPolicy20.png" src="../Images/AWSPolicy20.png" /></p>
</li>
<li>
<p>Scroll down and select a <strong>c5.large</strong>, and click <strong>Review and Launch</strong>:
<img alt="Images/AWSPolicy21.png" src="../Images/AWSPolicy21.png" /></p>
</li>
<li>
<p>Take note of the security group created (as you need to delete it), Click <strong>Launch</strong>:
<img alt="Images/AWSPolicy23.png" src="../Images/AWSPolicy23.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge..</strong> checkbox, and click <strong>Launch Instances</strong>:
<img alt="Images/AWSPolicy24.png" src="../Images/AWSPolicy24.png" /></p>
</li>
<li>
<p>You will get a success message, click on the instance id:
<img alt="Images/AWSPolicy25.png" src="../Images/AWSPolicy25.png" /></p>
</li>
<li>
<p>Ensure the correct instance is selected, click <strong>Actions</strong>, then <strong>Instance State</strong>, then <strong>Terminate</strong>:
<img alt="Images/AWSPolicy26.png" src="../Images/AWSPolicy26.png" /></p>
</li>
<li>
<p>Confirm the instance ID is correct, click <strong>Yes, Terminate</strong>:
<img alt="Images/AWSPolicy27.png" src="../Images/AWSPolicy27.png" /></p>
</li>
</ol>
<p>You have successfully implemented an IAM policy that restricts all EC2, RDS and S3 operations to a single region.</p>
<h2 id="3-create-an-iam-policy-to-restirct-ec2-usage-by-family">3. Create an IAM Policy to restirct EC2 usage by family <a name="EC2_restrict_family"></a></h2>
<p>AWS offers different instance families within EC2. Depending on your workload requirements - different types will be most cost effective. For non-specific environments such as testing or development, you can restrict the instance families in those accounts to the most cost effective generic types. It is also an effective way to increase RI utilization, by ensuring these accounts will consume any available Reserved Instances. </p>
<p>We will create a policy that allows operations on specific instance families only. This will not only restrict launching an instance, but all other activities. NOTE: it is best practice to provide only the minimum access required, the policy used here is for brevity and simplicity, and should only be implemented as a demonstration before being removed.</p>
<h3 id="31-create-the-iam-policy">3.1 Create the IAM Policy</h3>
<ol>
<li>
<p>Go to the <strong>IAM</strong> service page: 
<img alt="Images/AWSFamilyRestrict0.png" src="../Images/AWSFamilyRestrict0.png" /></p>
</li>
<li>
<p>Select <strong>Policies</strong> from the left menu:
<img alt="Images/AWSFamilyRestrict1.png" src="../Images/AWSFamilyRestrict1.png" /></p>
</li>
<li>
<p>Click <strong>Create Policy</strong>:
<img alt="Images/AWSFamilyRestrict2.png" src="../Images/AWSFamilyRestrict2.png" /></p>
</li>
<li>
<p>Click on the <strong>JSON</strong> tab:
<img alt="Images/AWSFamilyRestrict3.png" src="../Images/AWSFamilyRestrict3.png" /></p>
</li>
<li>
<p>Open the following text file, copy and paste the policy into the console:
<strong>NOTE</strong> Ensure you copy the entire policy, including the start '{' and end '}' 
<img alt="./Code/EC2Family_Restrict" src="./Code/EC2Family_Restrict" /> </p>
</li>
<li>
<p>Click <strong>Review policy</strong>:
<img alt="Images/AWSFamilyRestrict4.png" src="../Images/AWSFamilyRestrict4.png" /></p>
</li>
<li>
<p>Enter a <strong>Name</strong>, a <strong>Description</strong>, and click on <strong>Create Policy</strong>:
<img alt="Images/AWSFamilyRestrict5.png" src="../Images/AWSFamilyRestrict5.png" /></p>
</li>
</ol>
<h3 id="32-attach-the-policy-to-the-group">3.2 Attach the policy to the group</h3>
<ol>
<li>
<p>Click on <strong>Groups</strong> from the left menu: 
<img alt="Images/AWSFamilyRestrict6.png" src="../Images/AWSFamilyRestrict6.png" /></p>
</li>
<li>
<p>Click on the <strong>CostOptimization</strong> group (created previously):
<img alt="Images/AWSFamilyRestrict7.png" src="../Images/AWSFamilyRestrict7.png" /></p>
</li>
<li>
<p>We need to remove the <strong>RegionRestrict</strong> policy, as it permitted all EC2 actions. Click on <strong>Detach Policy</strong> for <strong>RegionRestrict</strong>:
<img alt="Images/AWSFamilyRestrict8.png" src="../Images/AWSFamilyRestrict8.png" /></p>
</li>
<li>
<p>Click on <strong>Detach</strong>:
<img alt="Images/AWSFamilyRestrict9.png" src="../Images/AWSFamilyRestrict9.png" /></p>
</li>
<li>
<p>Click on <strong>Attach Policy</strong>:
<img alt="Images/AWSFamilyRestrict10.png" src="../Images/AWSFamilyRestrict10.png" /></p>
</li>
<li>
<p>Click on <strong>Policy Type</strong>, then click <strong>Customer Managed</strong>:
<img alt="Images/AWSFamilyRestrict11.png" src="../Images/AWSFamilyRestrict11.png" /></p>
</li>
<li>
<p>Select the checkbox next to <strong>Ec2_FamilyRestrict</strong>, and click <strong>Attach Policy</strong>:
<img alt="Images/AWSFamilyRestrict12.png" src="../Images/AWSFamilyRestrict12.png" /></p>
</li>
</ol>
<h3 id="33-verify-the-policy-is-in-effect">3.3 Verify the policy is in effect</h3>
<ol>
<li>
<p>Click on <strong>Services</strong> and click <strong>EC2</strong>:
<img alt="Images/AWSFamilyRestrict13.png" src="../Images/AWSFamilyRestrict13.png" /></p>
</li>
<li>
<p>Click on <strong>Launch Instance</strong>:
<img alt="Images/AWSFamilyRestrict14.png" src="../Images/AWSFamilyRestrict14.png" /></p>
</li>
<li>
<p>Click on <strong>Select</strong> next to the <strong>Amazon Linux 2</strong> AMI:
<img alt="Images/AWSFamilyRestrict15.png" src="../Images/AWSFamilyRestrict15.png" /></p>
</li>
<li>
<p>We will select an instance we are not able to launch first, so select a <strong>c5.large</strong> instance, click <strong>Review and Launch</strong>:
<img alt="Images/AWSFamilyRestrict16.png" src="../Images/AWSFamilyRestrict16.png" /></p>
</li>
<li>
<p>Make note of the security group created, click <strong>Launch</strong>:
<img alt="Images/AWSFamilyRestrict17.png" src="../Images/AWSFamilyRestrict17.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge that i will not be able to...</strong>, then click <strong>Launch Instances</strong>: 
<img alt="Images/AWSFamilyRestrict18.png" src="../Images/AWSFamilyRestrict18.png" /></p>
</li>
<li>
<p>You will receive an error, notice the failed step was <strong>Initiating launches</strong>.  Click <strong>Back to Review Screen</strong>:
<img alt="Images/AWSFamilyRestrict19.png" src="../Images/AWSFamilyRestrict19.png" /></p>
</li>
<li>
<p>Click <strong>Edit instance type</strong>:
<img alt="Images/AWSFamilyRestrict20.png" src="../Images/AWSFamilyRestrict20.png" /></p>
</li>
<li>
<p>We will select an instance type we can launch (t3, a1 or m5) select <strong>t3.micro</strong>, and click <strong>Review and Launch</strong>:
<img alt="Images/AWSFamilyRestrict21.png" src="../Images/AWSFamilyRestrict21.png" /></p>
</li>
<li>
<p>Select <strong>Yes, I want to continue with this instance type (t3.micro)</strong>, click <strong>Next</strong>:
<img alt="Images/AWSFamilyRestrict22.png" src="../Images/AWSFamilyRestrict22.png" /></p>
</li>
<li>
<p>Click <strong>Launch</strong>:
<img alt="Images/AWSFamilyRestrict23.png" src="../Images/AWSFamilyRestrict23.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge that i will not be able to...</strong>, then click <strong>Launch Instances</strong>:
<img alt="Images/AWSFamilyRestrict24.png" src="../Images/AWSFamilyRestrict24.png" /></p>
</li>
<li>
<p>You will receive a success message.  Click on the <strong>Instance ID</strong> and terminate the instance as above:
<img alt="Images/AWSFamilyRestrict25.png" src="../Images/AWSFamilyRestrict25.png" /></p>
</li>
</ol>
<h2 id="4-extend-an-iam-policy-to-restrict-ec2-usage-by-instance-size">4. Extend an IAM Policy to restrict EC2 usage by instance size <a name="EC2_restrict_size"></a></h2>
<p>We can also restrict the size of instance that can be launched. This can be used to ensure only low cost instances can be created within an account. This is ideal for testing and development, where high capacity instances may not be required. We will extend the EC2 family policy above, and add restrictions by adding the sizes of instances allowed.</p>
<h3 id="41-extend-the-ec2family_restrict-iam-policy">4.1 Extend the EC2Family_Restrict IAM Policy</h3>
<ol>
<li>
<p>Go to the <strong>IAM</strong> service page: 
<img alt="Images/AWSFamilyUpdate0.png" src="../Images/AWSFamilyUpdate0.png" /></p>
</li>
<li>
<p>Click on <strong>Policies</strong> on the left menu:
<img alt="Images/AWSFamilyUpdate1.png" src="../Images/AWSFamilyUpdate1.png" /></p>
</li>
<li>
<p>Click on <strong>Filter policies</strong>, then select <strong>Customer managed</strong>:
<img alt="Images/AWSFamilyUpdate2.png" src="../Images/AWSFamilyUpdate2.png" /></p>
</li>
<li>
<p>Click on <strong>EC2_FamilyRestrict</strong> to modify it:
<img alt="Images/AWSFamilyUpdate3.png" src="../Images/AWSFamilyUpdate3.png" /></p>
</li>
<li>
<p>Click on <strong>Edit policy</strong>:
<img alt="Images/AWSFamilyUpdate4.png" src="../Images/AWSFamilyUpdate4.png" /></p>
</li>
<li>
<p>Click on the <strong>JSON</strong> tab:
<img alt="Images/AWSFamilyUpdate5.png" src="../Images/AWSFamilyUpdate5.png" /></p>
</li>
<li>
<p>Modify the policy by adding in the sizes, be careful not to change the syntax and only remove the * characters. Click on <strong>Review policy</strong>:
<img alt="Images/AWSFamilyUpdate6.png" src="../Images/AWSFamilyUpdate6.png" /></p>
</li>
<li>
<p>Click on <strong>Save changes</strong>:
<img alt="Images/AWSFamilyUpdate7.png" src="../Images/AWSFamilyUpdate7.png" /></p>
</li>
</ol>
<h3 id="42-verify-the-policy-is-in-effect">4.2 Verify the policy is in effect</h3>
<ol>
<li>
<p>Click on <strong>Services</strong> and go to the <strong>EC2</strong> dashboard:
<img alt="Images/AWSFamilyUpdate8.png" src="../Images/AWSFamilyUpdate8.png" /></p>
</li>
<li>
<p>Click on <strong>Launch Instance</strong>:
<img alt="Images/AWSFamilyUpdate9.png" src="../Images/AWSFamilyUpdate9.png" /></p>
</li>
<li>
<p>Click on <strong>Select</strong> next to the  <strong>Amazon Linux 2 AMI</strong>: 
<img alt="Images/AWSFamilyUpdate10.png" src="../Images/AWSFamilyUpdate10.png" /></p>
</li>
<li>
<p>We will attempt to launch a <strong>t3.micro</strong> which was successful before. Click on <strong>Review and Launch</strong>:
<img alt="Images/AWSFamilyUpdate11.png" src="../Images/AWSFamilyUpdate11.png" /></p>
</li>
<li>
<p>Review the configuraion and take note of the security group created, click <strong>Launch</strong>:
<img alt="Images/AWSFamilyUpdate12.png" src="../Images/AWSFamilyUpdate12.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge that i will not be able to...</strong>, then click <strong>Launch Instances</strong>:
<img alt="Images/AWSFamilyUpdate13.png" src="../Images/AWSFamilyUpdate13.png" /></p>
</li>
<li>
<p>You will get a failure, as it wasnt a size we allowed in the policy. Click <strong>Back to Review Screen</strong>:
<img alt="Images/AWSFamilyUpdate14.png" src="../Images/AWSFamilyUpdate14.png" /></p>
</li>
<li>
<p>Click <strong>Edit instance type</strong>: 
<img alt="Images/AWSFamilyUpdate15.png" src="../Images/AWSFamilyUpdate15.png" /></p>
</li>
<li>
<p>We will now select a <strong>t3.nano</strong> which will succeed. Click <strong>Review and Launch</strong>:
<img alt="Images/AWSFamilyUpdate16.png" src="../Images/AWSFamilyUpdate16.png" /></p>
</li>
<li>
<p>Select <strong>Yes, I want to continue with this instance type (t3.nano)</strong>, and click <strong>Next</strong>:
<img alt="Images/AWSFamilyUpdate17.png" src="../Images/AWSFamilyUpdate17.png" /></p>
</li>
<li>
<p>Review the configuration and click <strong>Launch</strong>:
<img alt="Images/AWSFamilyUpdate18.png" src="../Images/AWSFamilyUpdate18.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge that i will not be able to...</strong>, then click <strong>Launch Instances</strong>:
<img alt="Images/AWSFamilyUpdate19.png" src="../Images/AWSFamilyUpdate19.png" /></p>
</li>
<li>
<p>It will succeed. Click on the <strong>Instance ID</strong> and terminate the instance as above:
<img alt="Images/AWSFamilyUpdate20.png" src="../Images/AWSFamilyUpdate20.png" /></p>
</li>
</ol>
<p>You have successfully implemented an IAM policy that restricts all EC2 instance operations by family and size.</p>
<h2 id="5-create-an-iam-policy-to-restrict-ebs-volume-creation-by-volume-type">5. Create an IAM policy to restrict EBS Volume creation by volume type <a name="EC2_volume_type"></a></h2>
<p>Extending cost optimization governance beyond compute instances will ensure overall higher levels of cost optimization. Similar to EC2 instances, there are different storage types. Governing the type of storage that can be created in an account can be effective to minimise cost. </p>
<p>We will create an IAM policy that denies operations that contain provisioned IOPS (io1) EBS volume types. This will not only restrict creating a volume, but all other actions that attempt to use this volume type. NOTE: it is best practice to provide only the minimum access required, the policy used here is for brevity and simplicity, and should only be implemented as a demonstration before being removed.</p>
<h3 id="51-create-the-iam-policy">5.1 Create the IAM Policy</h3>
<ol>
<li>
<p>Go to the <strong>IAM</strong> service page: 
<img alt="Images/AWSEBSPolicy0.png" src="../Images/AWSEBSPolicy0.png" /></p>
</li>
<li>
<p>Click on <strong>Policies</strong> on the left menu:
<img alt="Images/AWSEBSPolicy1.png" src="../Images/AWSEBSPolicy1.png" /></p>
</li>
<li>
<p>Click <strong>Create policy</strong>:
<img alt="Images/AWSEBSPolicy2.png" src="../Images/AWSEBSPolicy2.png" /></p>
</li>
<li>
<p>Click on the <strong>JSON</strong> tab:
<img alt="Images/AWSEBSPolicy3.png" src="../Images/AWSEBSPolicy3.png" /></p>
</li>
<li>
<p>Open the following text file, copy and paste the policy into the console:
<strong>NOTE</strong> Ensure you copy the entire policy, including the start '{' and end '}' 
<img alt="./Code/EC2EBS_Restrict" src="./Code/EC2EBS_Restrict" /> </p>
</li>
<li>
<p>Click on <strong>Review Policy</strong>:
<img alt="Images/AWSEBSPolicy4.png" src="../Images/AWSEBSPolicy4.png" /></p>
</li>
<li>
<p>Enter a <strong>Name</strong> and a <strong>Description</strong>, and click <strong>Create policy</strong>:
<img alt="Images/AWSEBSPolicy5.png" src="../Images/AWSEBSPolicy5.png" /></p>
</li>
</ol>
<h3 id="52-attach-the-policy-to-the-cost-optimization-group">5.2 Attach the policy to the Cost Optimization group</h3>
<ol>
<li>
<p>Click on <strong>Groups</strong> from the left menu: 
<img alt="Images/AWSEBSPolicy6.png" src="../Images/AWSEBSPolicy6.png" /></p>
</li>
<li>
<p>Click on the <strong>CostOptimization</strong> group:
<img alt="Images/AWSEBSPolicy7.png" src="../Images/AWSEBSPolicy7.png" /></p>
</li>
<li>
<p>Click on <strong>Attach Policy</strong>:
<img alt="Images/AWSEBSPolicy8.png" src="../Images/AWSEBSPolicy8.png" /></p>
</li>
<li>
<p>Click on <strong>Policy Type</strong>, then click <strong>Customer Managed</strong>:
<img alt="Images/AWSEBSPolicy9.png" src="../Images/AWSEBSPolicy9.png" /></p>
</li>
<li>
<p>Select the checkbox next to <strong>EC2EBS_Restrict</strong>, and click <strong>Attach Policy</strong>:
<img alt="Images/AWSEBSPolicy10.png" src="../Images/AWSEBSPolicy10.png" /></p>
</li>
</ol>
<h3 id="53-verify-the-policy-is-in-effect">5.3 Verify the policy is in effect</h3>
<ol>
<li>
<p>Click on <strong>Services</strong> then click <strong>EC2</strong>:
<img alt="Images/AWSEBSPolicy11.png" src="../Images/AWSEBSPolicy11.png" /></p>
</li>
<li>
<p>Click <strong>Launch Instance</strong>:
<img alt="Images/AWSEBSPolicy12.png" src="../Images/AWSEBSPolicy12.png" /></p>
</li>
<li>
<p>Click <strong>Select</strong> next to <strong>Aamzon Linux 2...</strong>:
<img alt="Images/AWSEBSPolicy13.png" src="../Images/AWSEBSPolicy13.png" /></p>
</li>
<li>
<p>Select <strong>t3.nano</strong> (which is allowed as per our already applied policy, which we tested in the last exercise), click <strong>Next: Configure Instance Details</strong>:
<img alt="Images/AWSEBSPolicy14.png" src="../Images/AWSEBSPolicy14.png" /></p>
</li>
<li>
<p>Click <strong>Next Add Storage</strong>:
<img alt="Images/AWSEBSPolicy15.png" src="../Images/AWSEBSPolicy15.png" /></p>
</li>
<li>
<p>Click on <strong>Add New Volume</strong>, click on the <strong>dropdown</strong>, then select <strong>Provisioned IOPS SSD (io1)</strong>:
<img alt="Images/AWSEBSPolicy16.png" src="../Images/AWSEBSPolicy16.png" /></p>
</li>
<li>
<p>Click <strong>Review and Launch</strong>:
<img alt="Images/AWSEBSPolicy17.png" src="../Images/AWSEBSPolicy17.png" /></p>
</li>
<li>
<p>Take note of the security group created, and click <strong>Launch</strong>:
<img alt="Images/AWSEBSPolicy18.png" src="../Images/AWSEBSPolicy18.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge that i will not be able to...</strong>, then click <strong>Launch Instances</strong>:
<img alt="Images/AWSEBSPolicy19.png" src="../Images/AWSEBSPolicy19.png" /></p>
</li>
<li>
<p>The launch will fail, as it contained an io1 volume.  Click <strong>Back to Review Screen</strong>:
<img alt="Images/AWSEBSPolicy20.png" src="../Images/AWSEBSPolicy20.png" /></p>
</li>
<li>
<p>Click <strong>Edit storage</strong>:
<img alt="Images/AWSEBSPolicy21.png" src="../Images/AWSEBSPolicy21.png" /></p>
</li>
<li>
<p>Click the <strong>dropdown</strong> and change it to <strong>General Purpose SSD(gp2)</strong>, click <strong>Review and Launch</strong>: 
<img alt="Images/AWSEBSPolicy22.png" src="../Images/AWSEBSPolicy22.png" /></p>
</li>
<li>
<p>Select <strong>Proceed without a key pair</strong>, and click <strong>I acknowledge that i will not be able to...</strong>, then click <strong>Launch Instances</strong>:
<img alt="Images/AWSEBSPolicy23.png" src="../Images/AWSEBSPolicy23.png" /></p>
</li>
<li>
<p>It will now succeed, as it doesnt contain an io1 volume type.  Click on the <strong>instance ID</strong> and terminate the instance as above:
<img alt="Images/AWSEBSPolicy24.png" src="../Images/AWSEBSPolicy24.png" /></p>
</li>
</ol>
<h2 id="6-tear-down">6. Tear down <a name="tear_down"></a></h2>
<p>NOTE: The cost optimization user, group and policies are required for the completion of the fundamental labs. If you remove these resources you will not be able to complete the labs. There is no tear down for this component as it is best practices to have this group created in all organizations.</p>
<h3 id="delete-a-security-group">Delete a security group</h3>
<p>When you attempted to, and successfully launched instances above it created a <strong>launch-wizard</strong> security group automatically, which you will need to delete.</p>
<ol>
<li>
<p>Go to the EC2 Dashboard:
<img alt="Images/AWSTeardown1.png" src="../Images/AWSTeardown1.png" /></p>
</li>
<li>
<p>Confirm the instances launched as part of this exercise are terminated. Click on <strong>Instances</strong> on the left and view the instances. You can use the <strong>Launch Time</strong> column to verify this.
<img alt="Images/AWSTeardown15.png" src="../Images/AWSTeardown15.png" /></p>
</li>
<li>
<p>Select <strong>Security Groups</strong> under <strong>NETWORK AND SECURITY</strong> on the left:
<img alt="Images/AWSTeardown2.png" src="../Images/AWSTeardown2.png" /></p>
</li>
<li>
<p>Click the checkbox next to the security group you need to delete:
NOTE: you took note of the specific group in the exercise above, you can also use the <strong>Description</strong> column which will show when it was created.
<img alt="Images/AWSTeardown3.png" src="../Images/AWSTeardown3.png" /></p>
</li>
<li>
<p>Click <strong>Actions</strong>, then select <strong>Delete Security Group</strong>:
<img alt="Images/AWSTeardown4.png" src="../Images/AWSTeardown4.png" /></p>
</li>
<li>
<p>Click <strong>Yes, Delete</strong>:
<img alt="Images/AWSTeardown5.png" src="../Images/AWSTeardown5.png" /></p>
</li>
</ol>
<h3 id="remove-a-policy-from-a-group">Remove a policy from a group</h3>
<p>We will remove the IAM policies from our cost optimization group.</p>
<ol>
<li>
<p>Go to the IAM Console:
<img alt="Images/AWSPolicy1.png" src="../Images/AWSPolicy1.png" /></p>
</li>
<li>
<p>Select <strong>Groups</strong> from the left menu:
<img alt="Images/AWSTeardown6.png" src="../Images/AWSTeardown6.png" /></p>
</li>
<li>
<p>Click on the <strong>CostOptimization</strong> group (that was created previously):
<img alt="Images/AWSTeardown7.png" src="../Images/AWSTeardown7.png" /> </p>
</li>
<li>
<p>Click on <strong>Permissions</strong>:
<img alt="Images/AWSTeardown8.png" src="../Images/AWSTeardown8.png" /></p>
</li>
<li>
<p>Click on <strong>Detach Policy</strong> next to the <strong>EC2_FamilyRestrict</strong> and also <strong>EC2EBS_Restrict</strong> Policy Names:
<img alt="Images/AWSTeardown9.png" src="../Images/AWSTeardown9.png" /></p>
</li>
<li>
<p>Click <strong>Detach</strong>:
<img alt="Images/AWSTeardown10.png" src="../Images/AWSTeardown10.png" /></p>
</li>
<li>
<p>Repeat the steps above for <strong>EC2EBS_Restrict</strong>:
<img alt="Images/AWSTeardown9.5.png" src="../Images/AWSTeardown9.5.png" /></p>
</li>
<li>
<p>Click <strong>Detach</strong>:
<img alt="Images/AWSTeardown10.5.png" src="../Images/AWSTeardown10.5.png" /></p>
</li>
</ol>
<h3 id="delete-a-policy">Delete a policy</h3>
<p>We will delete the IAM policies created above, as they are no longer applied to any groups.</p>
<ol>
<li>
<p>Go to the IAM Console:
<img alt="Images/AWSPolicy1.png" src="../Images/AWSPolicy1.png" /></p>
</li>
<li>
<p>Click on <strong>Policies</strong> on the left:
<img alt="Images/AWSPolicy2.png" src="../Images/AWSPolicy2.png" /></p>
</li>
</ol>
<p>3.Click on <strong>Filter Policies</strong> and select <strong>Customer managed</strong>: 
<img alt="Images/AWSTeardown11.png" src="../Images/AWSTeardown11.png" /></p>
<ol>
<li>
<p>Select the policy you want to delete <strong>Region_Restrict</strong>:
<img alt="Images/AWSTeardown12.png" src="../Images/AWSTeardown12.png" /></p>
</li>
<li>
<p>Click on <strong>Policy actions</strong>, and select <strong>Delete</strong>:
<img alt="Images/AWSTeardown13.png" src="../Images/AWSTeardown13.png" /></p>
</li>
<li>
<p>Click on <strong>Delete</strong>:
<img alt="Images/AWSTeardown14.png" src="../Images/AWSTeardown14.png" /></p>
</li>
<li>
<p>Perform the same steps above to delete the <strong>Ec2_FamilyRestrict</strong> and <strong>EC2EBS_Restrict</strong> policies.</p>
</li>
</ol>
<h2 id="7-survey">7. Survey <a name="survey"></a></h2>
<p>Thanks for taking the lab, We hope that you can take this short survey (&lt;2 minutes), to share your insights and help us improve our content.</p>
<p><a href="https://amazonmr.au1.qualtrics.com/jfe/form/SV_9EPtEoy72tDcIDP"><img alt="Survey" src="../Images/survey.png" /></a></p>
<p>This survey is hosted by an external company (Qualtrics) , so the link above does not lead to our website.  Please note that AWS will own the data gathered via this survey and will not share the information/results collected with survey respondents.  Your responses to this survey will be subject to Amazons Privacy Policy.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
